var b=["My chceme znovu motýle","Není to moje. Je to nějaký firmy, která patří do holdingu","Nikdy neodstoupím, nikdy! Nech si to všichni zapamatují. Nikdy","ti, kteří měli přijít, nepřišli","Best in covid","Ano, lobboval jsem za biopaliva","Orbán je můj přítel, naše vztahy jsou skutečně nadstandardní"],T=[{url:"https://picsum.photos/800",weight:5},{url:"https://source.unsplash.com/800x800",weight:10},{url:"https://source.unsplash.com/800x800/?communism",weight:3},{url:"https://source.unsplash.com/800x800/?cat",weight:1},{url:"https://source.unsplash.com/800x800/?puppy",weight:1},{url:"https://source.unsplash.com/800x800/?chicken",weight:1},{url:"https://source.unsplash.com/800x800/?angry",weight:3}];var L=(t,s)=>{let a=[];for(;t.length>s;){let e=t.substring(0,s).lastIndexOf(" ");e=e<=0?s:e,a.push(t.substring(0,e));let n=t.indexOf(" ",e)+1;(n<e||n>e+s)&&(n=e),t=t.substring(n)}return a.push(t),a},w=t=>t[Math.floor(Math.random()*t.length)],B=(t,s=6)=>{let a=(i,c,m)=>.2126*i+.7152*c+.0722*m,e=0,n=0;for(let i=0;i<t.length;i+=3*s){let[c,m,p]=[t[i]/255,t[i+1]/255,t[i+2]/255],g=a(c,m,p);Number.isNaN(g)||(e+=g,n+=1)}return e/n};var j=480,R=30;var A=T.flatMap(({url:t,weight:s})=>Array(s).fill(t)),N=new FileReader,d=new Image;d.src="public/logo-light.png";var l=new Image,y="Test text",E=async()=>{let t=await fetch(w(A));return new Promise(s=>{let a=new Image;a.addEventListener("load",()=>{l=a,s()}),a.crossOrigin="anonymous",a.src=t.url})},I=()=>{y=w(b)},z=(t,s)=>{for(var a=t.getImageData(0,0,s.width,s.height),e=a.data,n=0,i=e.length;n<i;n+=4){var c=e[n]*.3+e[n+1]*.59+e[n+2]*.11;e[n]=c,e[n+1]=c,e[n+2]=c}t.putImageData(a,0,0)},r=document.getElementById("picture"),o=r.getContext("2d"),O=new FontFace("Bebas Neue","url(public/BebasNeue-Bold.ttf)"),C=async()=>{await O.load(),document.fonts.add(O)},S=t=>{!t.type.startsWith("image/")||N.readAsDataURL(t)};r.addEventListener("dragover",t=>t.preventDefault());r.addEventListener("drop",t=>{t.preventDefault(),!(!t.dataTransfer||t.dataTransfer.files.length<=0)&&S(t.dataTransfer.files[0])});var u=async()=>{o.fillStyle="black",o.fillRect(0,0,r.width,r.height);let t=r.width/l.width,s=r.height/l.height,a=Math.max(t,s);o.setTransform(a,0,0,a,0,0),o.drawImage(l,0,0),z(o,r),o.setTransform();let e=o.getImageData(j,R,d.width,d.height).data,n=B(e);o.drawImage(d,j,R,d.width/2.5,d.height/2.5);let i=L(y,20).reverse(),c=i.length<5?60:40;o.font=`${c}px 'Bebas Neue'`,i.forEach((m,p)=>{let g=30,x=685,h=15,v=h+c;o.fillStyle="#00ff00",o.fillRect(g,x-p*v,o.measureText(m).width+2*h,v),o.textBaseline="top",o.fillStyle="black",o.fillText(m,g+h,x+h-p*v)})};N.addEventListener("load",t=>{l=new Image,l.addEventListener("load",()=>u()),l.src=t.target.result});var M=document.getElementById("randomize");M.addEventListener("click",async()=>{I(),await E(),u()});var _=document.getElementById("randomize-img");_.addEventListener("click",async()=>{await E(),u()});var G=document.getElementById("randomize-text");G.addEventListener("click",()=>{I(),u()});var D=document.getElementById("customImage");D.addEventListener("change",t=>{t.preventDefault(),!(t.target.files.length<=0)&&S(t.target.files[0])});var H=document.getElementById("customImageBtn");H.addEventListener("click",()=>{D.click()});var f=document.getElementById("customText"),F=async t=>{(t.type==="input"||f.value)&&(y=f.value,u())};f.addEventListener("click",F);f.addEventListener("input",F);var k=document.createElement("a");k.setAttribute("download","PirStanKampan.jpg");var U=document.getElementById("save");U.addEventListener("click",t=>{t.preventDefault(),k.setAttribute("href",r.toDataURL("image/jpeg").replace("image/jpeg","image/octet-stream")),k.click()});C();I();E().then(()=>u());
//# sourceMappingURL=index.js.map
